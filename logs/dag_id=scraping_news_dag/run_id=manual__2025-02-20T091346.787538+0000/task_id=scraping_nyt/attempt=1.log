[2025-02-20T09:13:49.874+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: scraping_news_dag.scraping_nyt manual__2025-02-20T09:13:46.787538+00:00 [queued]>
[2025-02-20T09:13:49.893+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: scraping_news_dag.scraping_nyt manual__2025-02-20T09:13:46.787538+00:00 [queued]>
[2025-02-20T09:13:49.894+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2025-02-20T09:13:49.920+0000] {taskinstance.py:2214} INFO - Executing <Task(_PythonDecoratedOperator): scraping_nyt> on 2025-02-20 09:13:46.787538+00:00
[2025-02-20T09:13:49.929+0000] {standard_task_runner.py:60} INFO - Started process 20013 to run task
[2025-02-20T09:13:49.935+0000] {standard_task_runner.py:87} INFO - Running: ['airflow', 'tasks', 'run', 'scraping_news_dag', 'scraping_nyt', 'manual__2025-02-20T09:13:46.787538+00:00', '--job-id', '188', '--raw', '--subdir', 'DAGS_FOLDER/scraping-news-dag.py', '--cfg-path', '/tmp/tmpoq7doxgx']
[2025-02-20T09:13:49.939+0000] {standard_task_runner.py:88} INFO - Job 188: Subtask scraping_nyt
[2025-02-20T09:13:49.967+0000] {logging_mixin.py:188} WARNING - /home/airflow/.local/lib/python3.9/site-packages/airflow/settings.py:194 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-02-20T09:13:50.042+0000] {task_command.py:423} INFO - Running <TaskInstance: scraping_news_dag.scraping_nyt manual__2025-02-20T09:13:46.787538+00:00 [running]> on host deproject-airflow-scheduler
[2025-02-20T09:13:50.247+0000] {taskinstance.py:2510} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='scraping_news_dag' AIRFLOW_CTX_TASK_ID='scraping_nyt' AIRFLOW_CTX_EXECUTION_DATE='2025-02-20T09:13:46.787538+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-02-20T09:13:46.787538+00:00'
[2025-02-20T09:13:51.375+0000] {logger.py:11} INFO - ====== WebDriver manager ======
[2025-02-20T09:13:51.759+0000] {logger.py:11} INFO - Get LATEST chromedriver version for google-chrome
[2025-02-20T09:13:51.913+0000] {logger.py:11} INFO - Get LATEST chromedriver version for google-chrome
[2025-02-20T09:13:52.099+0000] {logger.py:11} INFO - Driver [/home/airflow/.wdm/drivers/chromedriver/linux64/133.0.6943.126/chromedriver-linux64/chromedriver] found in cache
[2025-02-20T09:14:47.421+0000] {logging_mixin.py:188} INFO - Total scraped: 100
[2025-02-20T09:15:36.883+0000] {local_task_job_runner.py:302} WARNING - State of this instance has been externally set to failed. Terminating instance.
[2025-02-20T09:15:36.892+0000] {process_utils.py:131} INFO - Sending 15 to group 20013. PIDs of all processes in the group: [20038, 20044, 20048, 20051, 20076, 20225, 20077, 20135, 21236, 21267, 21283, 21295, 21304, 21317, 21338, 21340, 20075, 20013]
[2025-02-20T09:15:36.893+0000] {process_utils.py:86} INFO - Sending the signal 15 to group 20013
[2025-02-20T09:15:36.897+0000] {taskinstance.py:2480} ERROR - Received SIGTERM. Terminating subprocesses.
[2025-02-20T09:15:36.934+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=21236, status='terminated', started='09:14:43') (21236) terminated with exit code None
[2025-02-20T09:15:36.951+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=21295, status='terminated', started='09:14:46') (21295) terminated with exit code None
[2025-02-20T09:15:37.013+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=20075, status='terminated', started='09:13:52') (20075) terminated with exit code None
[2025-02-20T09:15:37.068+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=20076, status='terminated', started='09:13:52') (20076) terminated with exit code None
[2025-02-20T09:15:37.070+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=21283, status='terminated', started='09:14:45') (21283) terminated with exit code None
[2025-02-20T09:15:37.071+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=20135, status='terminated', started='09:13:52') (20135) terminated with exit code None
[2025-02-20T09:15:37.072+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=21340, status='terminated', started='09:14:47') (21340) terminated with exit code None
[2025-02-20T09:15:37.259+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=21267, status='terminated', started='09:14:44') (21267) terminated with exit code None
[2025-02-20T09:15:37.261+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=20225, status='terminated', started='09:13:59') (20225) terminated with exit code None
[2025-02-20T09:15:37.262+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=21317, status='terminated', started='09:14:46') (21317) terminated with exit code None
[2025-02-20T09:15:37.263+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=21338, status='terminated', started='09:14:47') (21338) terminated with exit code None
[2025-02-20T09:15:37.264+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=20044, status='terminated', started='09:13:52') (20044) terminated with exit code None
[2025-02-20T09:15:37.265+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=20077, status='terminated', started='09:13:52') (20077) terminated with exit code None
[2025-02-20T09:15:37.267+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=20051, status='terminated', started='09:13:52') (20051) terminated with exit code None
[2025-02-20T09:15:37.268+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=21304, status='terminated', started='09:14:46') (21304) terminated with exit code None
[2025-02-20T09:15:37.604+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=20048, status='terminated', started='09:13:52') (20048) terminated with exit code None
[2025-02-20T09:15:38.325+0000] {connectionpool.py:824} WARNING - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7ff9c49c36a0>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/6639ac8459997a8601ac523d3f1aab5c/url
[2025-02-20T09:15:38.328+0000] {connectionpool.py:824} WARNING - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7ff9c49c3ac0>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/6639ac8459997a8601ac523d3f1aab5c/url
[2025-02-20T09:15:38.333+0000] {connectionpool.py:824} WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7ff9ae7636d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/6639ac8459997a8601ac523d3f1aab5c/url
[2025-02-20T09:15:38.340+0000] {connectionpool.py:824} WARNING - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7ff9ae6f7a30>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/6639ac8459997a8601ac523d3f1aab5c
[2025-02-20T09:15:38.342+0000] {connectionpool.py:824} WARNING - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7ff9ae6f72e0>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/6639ac8459997a8601ac523d3f1aab5c
[2025-02-20T09:15:38.344+0000] {connectionpool.py:824} WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7ff9ae6f76d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/6639ac8459997a8601ac523d3f1aab5c
[2025-02-20T09:15:38.354+0000] {taskinstance.py:2728} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.9/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/airflow/.local/lib/python3.9/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.9/site-packages/urllib3/connectionpool.py", line 416, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.9/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.9/http/client.py", line 1285, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.9/http/client.py", line 1331, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.9/http/client.py", line 1280, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.9/http/client.py", line 1040, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.9/http/client.py", line 980, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.9/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.9/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7ff9ae730370>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/decorators/base.py", line 241, in execute
    return_value = super().execute(context)
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/scraping-news-dag.py", line 26, in scrapping
    df = module_map[table_name].main()
  File "/opt/airflow/dags/source/nyt.py", line 85, in main
    driver.get(section_url)
  File "/home/airflow/.local/lib/python3.9/site-packages/selenium/webdriver/remote/webdriver.py", line 454, in get
    self.execute(Command.GET, {"url": url})
  File "/home/airflow/.local/lib/python3.9/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/home/airflow/.local/lib/python3.9/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
  File "/home/airflow/.local/lib/python3.9/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/home/airflow/.local/lib/python3.9/site-packages/urllib3/request.py", line 81, in request
    return self.request_encode_body(
  File "/home/airflow/.local/lib/python3.9/site-packages/urllib3/request.py", line 173, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
  File "/home/airflow/.local/lib/python3.9/site-packages/urllib3/poolmanager.py", line 376, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/home/airflow/.local/lib/python3.9/site-packages/urllib3/connectionpool.py", line 827, in urlopen
    return self.urlopen(
  File "/home/airflow/.local/lib/python3.9/site-packages/urllib3/connectionpool.py", line 827, in urlopen
    return self.urlopen(
  File "/home/airflow/.local/lib/python3.9/site-packages/urllib3/connectionpool.py", line 827, in urlopen
    return self.urlopen(
  File "/home/airflow/.local/lib/python3.9/site-packages/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
  File "/home/airflow/.local/lib/python3.9/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=39627): Max retries exceeded with url: /session/6639ac8459997a8601ac523d3f1aab5c/url (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7ff9ae730370>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-02-20T09:15:38.407+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=scraping_news_dag, task_id=scraping_nyt, execution_date=20250220T091346, start_date=20250220T091349, end_date=20250220T091538
[2025-02-20T09:15:38.434+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 188 for task scraping_nyt (HTTPConnectionPool(host='localhost', port=39627): Max retries exceeded with url: /session/6639ac8459997a8601ac523d3f1aab5c/url (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7ff9ae730370>: Failed to establish a new connection: [Errno 111] Connection refused')); 20013)
[2025-02-20T09:15:38.478+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=20038, status='terminated', started='09:13:51') (20038) terminated with exit code None
[2025-02-20T09:15:38.479+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=20013, status='terminated', exitcode=1, started='09:13:49') (20013) terminated with exit code 1
